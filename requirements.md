# 电流分析UI应用需求文档

## 项目概述
开发一个GUI应用程序，用于分析TDMS和NPZ文件中的电流数据，并提供交互式数据分析功能。

## 功能需求

### 1. 文件加载功能
- 支持加载TDMS文件格式
- 支持加载NPZ文件格式
- 文件选择器界面，允许用户浏览和选择文件

### 2. 数据处理
- **TDMS文件处理**：
  - 读取文件中含有"samplerate"字段的采样频率信息
  - 将数据点转换为正确的时间序列（基于采样频率）
- **NPZ文件处理**：
  - 读取numpy压缩文件中的"current"和"time"字段

### 3. 数据可视化
- **交互式图表**：
  - 横坐标：时间 (s)
  - 纵坐标：电流 (A)
  - 支持鼠标操作（缩放、平移、选择等）
  - 实时显示鼠标位置的坐标值

### 4. 数据分析功能
- **阈值分析**：
  - 用户输入threshold值的输入框
  - "Analyze"按钮触发分析
  - 筛选出小于threshold的电流数据段
  
- **峰值检测**：
  - 在筛选出的数据段中，检测下降幅度超过n倍电流标准差的峰
  - n值由用户通过输入框指定
  - 记录峰值对应的时间点
  
- **电流标准差计算**：
  - 默认使用数据前250个点计算标准差
  - 提供"Standard Deviation"按钮，允许用户在图形上手动选区计算标准差

### 5. 结果导出
- **CSV文件导出**：
  - 列1：事件名称（用户可编辑）
  - 列2：峰值时间
  - 列3：下降幅度值
  - 自动保存或手动保存选项

## 用户界面设计要求
- 简洁直观的操作界面
- 文件加载区域
- 参数设置区域（threshold输入、n值输入）
- "Standard Deviation"按钮（用于手动选区计算标准差）
- 大面积的图表显示区域
- 结果显示和导出区域

## 技术要求
- Python + PyQt框架
- 支持TDMS文件格式读取
- 支持NPZ文件格式读取
- 交互式图表库（建议使用pyqtgraph或matplotlib）
- CSV文件操作
- 跨平台兼容性

## 用户交互流程
1. 用户选择并加载TDMS或NPZ文件
2. 系统自动绘制时间-电流曲线图
3. 用户设置threshold参数和n值（峰值检测倍数）
4. （可选）用户点击"Standard Deviation"按钮，在图上选区重新计算标准差
5. 点击"Analyze"按钮进行分析
6. 系统识别峰值并显示结果
7. 用户输入事件名称
8. 导出结果到CSV文件